(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{214:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/graph-view-complex-ac8d2ee0ba32563b73228f49487c2e19.png"},316:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/pathom-viz-cebb84b67563fd3911cbe8b233c751f4.png"},317:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/connect-35127a5aba4c604a00223928ec44fee5.gif"},318:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/query-editor-2f467fac8b3047590a6908dbfae93c8d.png"},319:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/query-editor-auto-complete-35b14ca4f5b723532e66633b28355a68.png"},320:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/trace-view-f89791bf7805a63c26778002c7e3b052.png"},321:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/trace-nested-1a795ac5a409824dd58c4cc54862ee86.png"},322:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/graph-view-d03901c07eaf80f1459bfd027ed6ba2b.png"},80:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return i})),a.d(t,"metadata",(function(){return c})),a.d(t,"rightToc",(function(){return s})),a.d(t,"default",(function(){return l}));var n=a(2),o=a(6),r=(a(0),a(97)),i={title:"Debugging"},c={unversionedId:"debugging",id:"debugging",isDocsHomePage:!1,title:"Debugging",description:"On this page, you will find information on how to debug problems using Pathom 3.",source:"@site/docs/debugging.mdx",slug:"/debugging",permalink:"/docs/debugging",editUrl:"https://github.com/wilkerlucio/pathom3-docs/edit/master/docs/debugging.mdx",version:"current",sidebar:"docs",previous:{title:"Async",permalink:"/docs/async"},next:{title:"Indexes",permalink:"/docs/indexes"}},s=[{value:"REPL debug",id:"repl-debug",children:[{value:"Pathom Run Stats",id:"pathom-run-stats",children:[]},{value:"Smart Stats",id:"smart-stats",children:[]},{value:"Error for some attribute",id:"error-for-some-attribute",children:[]}]},{value:"Debug with Pathom Viz",id:"debug-with-pathom-viz",children:[{value:"Download the app",id:"download-the-app",children:[]},{value:"Connect the app",id:"connect-the-app",children:[]},{value:"Query Editor",id:"query-editor",children:[]},{value:"Tracer View",id:"tracer-view",children:[]},{value:"Graph View",id:"graph-view",children:[]},{value:"Index Explorer",id:"index-explorer",children:[]},{value:"Requests",id:"requests",children:[]}]}],p={rightToc:s};function l(e){var t=e.components,i=Object(o.a)(e,["components"]);return Object(r.b)("wrapper",Object(n.a)({},p,i,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"On this page, you will find information on how to debug problems using Pathom 3."),Object(r.b)("h2",{id:"repl-debug"},"REPL debug"),Object(r.b)("p",null,"First, we will see how to inspect the stats of a Pathom process using the REPL."),Object(r.b)("h3",{id:"pathom-run-stats"},"Pathom Run Stats"),Object(r.b)("p",null,"When Pathom runs, it also generates some data\nabout what happened on top of developing your response. This data includes the plan generated for your request and details about what happened to run each node in this graph."),Object(r.b)("p",null,"You can find this data living the ",Object(r.b)("inlineCode",{parentName:"p"},"meta")," data of the returned map. This works for the\n",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/eql"}),"EQL")," interface and if you use the runner directly. To see this data with\n",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/smart-maps"}),"Smart Maps")," you should use the ",Object(r.b)("inlineCode",{parentName:"p"},"psm/get-with-stats")," helper."),Object(r.b)("p",null,"Let's have a look at what is inside this data, and this is our source example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-clojure"}),"(pco/defresolver area [{:keys [width height]}]\n  {:area (* width height)})\n\n(pco/defresolver width [{:keys [x x2]}]\n  {:width (- x2 x)})\n\n(def env\n  (pci/register\n    [area width]))\n\n(p.eql/process\n  env\n  {:x 10 :x2 30 :height 40}\n  [:area])\n")),Object(r.b)("p",null,"The result map is ",Object(r.b)("inlineCode",{parentName:"p"},"{:area 800}"),". Now let's look at what is in ",Object(r.b)("inlineCode",{parentName:"p"},"meta"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-clojure"}),"{::pcr/run-stats\n {::pcr/compute-plan-run-start-ms\n  3.701837395085457E9\n\n  ::pcr/compute-plan-run-finish-ms\n  3.701837397421086E9\n\n  ::pcr/graph-run-start-ms\n  3.701837395080634E9\n\n  ::pcr/graph-run-finish-ms\n  3.701837399062158E9\n\n  ::pcr/node-run-stats\n  {2\n   {::pcr/resolver-run-start-ms  3.701837397955496E9\n    ::pcr/resolver-run-finish-ms 3.701837397997367E9\n    ::pcr/node-run-input         {:x 10, :x2 30}\n    ::pcr/node-run-output        {:width 20}}\n   1\n   {::pcr/resolver-run-start-ms  3.701837398639112E9\n    ::pcr/resolver-run-finish-ms 3.701837398674007E9\n    ::pcr/node-run-input         {:width 20, :height 40}\n    ::pcr/node-run-output        {:area 800}}}\n\n  ::pcp/index-ast\n  {:area {:type :prop, :dispatch-key :area, :key :area}}\n\n  ::pcp/index-attrs\n  {:width #{2}, :area #{1}}\n\n  ::pcp/index-resolver->nodes\n  {com.wsscode.pathom3.demos.troubleshoot/area  #{1}\n   com.wsscode.pathom3.demos.troubleshoot/width #{2}}\n\n  ::pcp/root\n  2\n\n  ::pcp/nodes\n  {1\n   {::pco/op-name          com.wsscode.pathom3.demos.troubleshoot/area\n    ::pcp/node-id          1\n    ::pcp/expects          {:area {}}\n    ::pcp/input            {:width {}, :height {}}\n    ::pcp/node-parents     #{2}\n    ::pcp/source-for-attrs #{:area}}\n   2\n   {::pco/op-name          com.wsscode.pathom3.demos.troubleshoot/width\n    ::pcp/node-id          2\n    ::pcp/expects          {:width {}}\n    ::pcp/input            {:x {}, :x2 {}}\n    ::pcp/source-for-attrs #{:width}\n    ::pcp/run-next         1}}}}\n")),Object(r.b)("div",{className:"admonition admonition-important alert alert--info"},Object(r.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(r.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"important")),Object(r.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"Take some time to read the available data from stats. If the name of some attribute\ndoesn't make sense to you, navigate to the spec definition of that property to find\na text description of it."))),Object(r.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(r.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(r.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"tip")),Object(r.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"Note we have a mix of ",Object(r.b)("inlineCode",{parentName:"p"},"::pcp")," (planner) and ",Object(r.b)("inlineCode",{parentName:"p"},"::pcr")," (runner) keys in this map root. The\nnamespace is an indication of what part of the system owns that key."))),Object(r.b)("p",null,"On top of the plan data, the runner data includes runtime information about the execution.\nThis data contains timestamps for many events and specialized data depending on the kind of node."),Object(r.b)("h4",{id:"looking-for-issues"},"Looking for issues"),Object(r.b)("p",null,"Let's write a broken query to debug it:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-clojure"}),"(-> (p.eql/process\n      env\n      {:x 10 :height 40}\n      [:area])\n\n    (meta)\n    ::pcr/run-stats)\n=>\n{::pcp/index-ast                  {:area {:dispatch-key :area,\n                                          :key          :area,\n                                          :type         :prop}},\n ::pcp/nodes                      {},\n ::pcp/unreachable-paths          {:area {}, :width {}, :x2 {}},\n ::pcp/unreachable-resolvers      #{com.wsscode.pathom3.docs.demos.core.debugging/width\n                                    com.wsscode.pathom3.docs.demos.core.debugging/area},\n ::pcr/compute-plan-run-finish-ms 1.017579107877868E9,\n ::pcr/compute-plan-run-start-ms  1.017579107436291E9,\n ::pcr/graph-run-finish-ms        1.017579107898803E9,\n ::pcr/graph-run-start-ms         1.017579107430066E9,\n ::pcr/node-run-stats             {}}\n")),Object(r.b)("p",null,"Most notably, check ",Object(r.b)("inlineCode",{parentName:"p"},"::pcp/unreachable-paths")," and ",Object(r.b)("inlineCode",{parentName:"p"},"::pcp/unreachable-resolvers"),". Looking\nat then we can see what Pathom tried but failed to accomplish. This a good time to look\nfor typos or check if there is missing information on your data."),Object(r.b)("h3",{id:"smart-stats"},"Smart Stats"),Object(r.b)("p",null,"During process time, Pathom collects the minimum data as it can to reduce the\noverhead. So, for example, it won't calculate durations during this process. Simultaneously, if the data were available as simple props, that would also be great."),Object(r.b)("p",null,"To get the best of both worlds, Pathom provides resolvers that do these interesting\ncomputations. Using those with a Smart Map gives easy access to these attributes while\nadding zero cost at processing time."),Object(r.b)("p",null,"An easy helper to start a smart stats is available at the Smart Maps namespace. Here is an example to fetch the total process duration from run stats:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-clojure"}),"(-> (p.eql/process\n      env\n      {:x 10 :x2 30 :height 40}\n      [:area])\n\n    (meta)\n    ::pcr/run-stats\n    (psm/smart-run-stats)\n\n    ::pcr/process-run-duration-ms)\n; => 0.6624890565872192\n")),Object(r.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(r.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(r.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"tip")),Object(r.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"You can use datafy to explore the available attributes from the\nsmart stats (as you can with any Smart Map):"),Object(r.b)("pre",{parentName:"div"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-clojure"}),"(-> (p.eql/process\n      env\n      {:x 10 :x2 30 :height 40}\n      [:area])\n\n    (meta)\n    ::pcr/run-stats\n    (psm/smart-run-stats)\n\n    clojure.datafy/datafy)\n")))),Object(r.b)("h3",{id:"error-for-some-attribute"},"Error for some attribute"),Object(r.b)("p",null,"In many cases, what you care about is the status of some specific attribute. Errors get\nlocated in the run stats of the node. The graph has the ",Object(r.b)("inlineCode",{parentName:"p"},"::pcp/index-attrs"),", which tells\nwhich node is responsible for a given attribute."),Object(r.b)("p",null,"Here is an example of an execution with error. We're going to put a string where it should\nbe a number, causing a math exception:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-clojure",metastring:":com.wsscode.pathom3.connect.planner/run-next 1}}}",":com.wsscode.pathom3.connect.planner/run-next":!0,"1}}}":!0}),'(p.eql/process\n  env\n  {:x 10 :x2 "foo" :height 40}\n  [:area])\n=> {}\n')),Object(r.b)("p",null,"We can see the response is silent in the output, but looking at meta\nwe can see the diagnostics:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-clojure"}),'(-> (p.eql/process\n      env\n      {:x 10 :x2 "foo" :height 40}\n      [:area])\n    (meta)\n    ::pcr/run-stats)\n=>\n{::pcp/index-attrs                {:width #{2}, :area #{1}},\n ::pcr/compute-plan-run-finish-ms 1.019610883512772E9,\n ::pcr/graph-run-finish-ms        1.01961088367712E9,\n ::pcr/compute-plan-run-start-ms  1.019610883061625E9,\n ::pcp/root                       2,\n ::pcr/node-run-stats             {2\n                                   #::pcr{:node-run-start-ms      1.019610883534996E9,\n                                          :node-error             #error{:cause "class java.lang.String cannot be cast to class java.lang.Number (java.lang.String and java.lang.Number are in module java.base of loader \'bootstrap\')",\n                                                                         :via   [{:type    java.lang.ClassCastException,\n                                                                                  :message "class java.lang.String cannot be cast to class java.lang.Number (java.lang.String and java.lang.Number are in module java.base of loader \'bootstrap\')",\n                                                                                  :at      [clojure.lang.Numbers\n                                                                                            minus\n                                                                                            "Numbers.java"\n                                                                                            162]}],\n                                                                         :trace ...},\n                                          :resolver-run-start-ms  1.019610883569344E9,\n                                          :resolver-run-finish-ms 1.019610883641287E9,\n                                          :node-resolver-input    {:x  10,\n                                                                   :x2 "foo"},\n                                          :node-resolver-output   ::pcr/node-error,\n                                          :node-run-finish-ms     1.019610883656152E9},\n\n                                   ::pcr/nodes-with-error\n                                   #{2}},\n ::pcp/index-ast                  {:area {:type         :prop,\n                                          :dispatch-key :area,\n                                          :key          :area}},\n ::pcr/graph-run-start-ms         1.019610883053178E9,\n ::pcp/index-resolver->nodes      #:com.wsscode.pathom3.docs.demos.core.debugging{area  #{1},\n                                                                                  width #{2}},\n ::pcp/nodes                      {1 {::pco/op-name          com.wsscode.pathom3.docs.demos.core.debugging/area,\n                                      ::pcp/node-id          1,\n                                      ::pcp/expects          {:area {}},\n                                      ::pcp/input            {:width  {},\n                                                              :height {}},\n                                      ::pcp/node-parents     #{2},\n                                      ::pcp/source-for-attrs #{:area}},\n                                   2 {::pco/op-name          com.wsscode.pathom3.docs.demos.core.debugging/width,\n                                      ::pcp/node-id          2,\n                                      ::pcp/expects          {:width {}},\n                                      ::pcp/input            {:x  {},\n                                                              :x2 {}},\n                                      ::pcp/source-for-attrs #{:width},\n                                      ::pcp/run-next         1}}}\n')),Object(r.b)("p",null,"We wanted the attribute ",Object(r.b)("inlineCode",{parentName:"p"},":area"),", at the ",Object(r.b)("inlineCode",{parentName:"p"},"::pcp/index-attrs")," we can see the node for it\nis the node ",Object(r.b)("inlineCode",{parentName:"p"},"1"),". We can also see the error in the stats but at the node ",Object(r.b)("inlineCode",{parentName:"p"},"2"),"."),Object(r.b)("p",null,"This is why just looking at the node responsible is a naive solution. The correct solution\nto look at the node first, and if the error isn't there, traverse back the graph to\nfind the issue."),Object(r.b)("p",null,"Pathom provides a solution built-in to handle that, the function ",Object(r.b)("inlineCode",{parentName:"p"},"get-attribute-error"),"\nin the ",Object(r.b)("inlineCode",{parentName:"p"},"com.wsscode.pathom3.connect.runner.stats")," namespace:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-clojure"}),'(-> (p.eql/process\n      env\n      {:x 10 :x2 "foo" :height 40}\n      [:area])\n\n    (meta)\n    ::pcr/run-stats\n    psm/smart-run-stats\n    (pcrs/get-attribute-error :area))\n=>\n{::pcrs/node-error-type\n ::pcrs/node-error-type-ancestor\n\n ::pcrs/node-error-id\n 2,\n\n ::pcr/node-error\n #error{:cause "class java.lang.String cannot be cast to class java.lang.Number (java.lang.String and java.lang.Number are in module java.base of loader \'bootstrap\')",\n        :via   [{:type    java.lang.ClassCastException,\n                 :message "class java.lang.String cannot be cast to class java.lang.Number (java.lang.String and java.lang.Number are in module java.base of loader \'bootstrap\')",\n                 :at      [clojure.lang.Numbers\n                           minus\n                           "Numbers.java"\n                           162]}],\n        :trace ...}}\n')),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"::pcrs/node-error-type")," may be:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"::pcrs/node-error-type-direct"),": error happened in the node responsible for the attribute"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"::pcrs/node-error-type-ancestor"),": error happened in some ancestor"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"::pcrs/node-error-type-unreachable"),": can't figure a path to reach this attribute")),Object(r.b)("p",null,"In the case of ",Object(r.b)("inlineCode",{parentName:"p"},"::pcrs/node-error-type-ancestor"),", there will be a ",Object(r.b)("inlineCode",{parentName:"p"},"::pcrs/node-error-id"),"\nto tell which node was responsible for the failure."),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(r.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(r.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"Smart Run Stats is a good example of how you can use Pathom Smart Maps to have lazy access\nto derived data, instead of doing eager computations."))),Object(r.b)("h2",{id:"debug-with-pathom-viz"},"Debug with Pathom Viz"),Object(r.b)("div",{className:"pathom-diagram"},Object(r.b)("p",null,"  ",Object(r.b)("img",{alt:"Pathom Viz",src:a(316).default}))),Object(r.b)("p",null,Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/wilkerlucio/pathom-viz/"}),"Pathom Viz")," is a developer app created to\nassist in the development with Pathom. In Pathom Viz you can:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Run queries with an auto-complete feature in the tool editor"),Object(r.b)("li",{parentName:"ul"},"Trace the requests to understand the bottlenecks of the process"),Object(r.b)("li",{parentName:"ul"},"Explore the app index with Index Explorer"),Object(r.b)("li",{parentName:"ul"},"Track all requests made to your app, and see trace details of those")),Object(r.b)("h3",{id:"download-the-app"},"Download the app"),Object(r.b)("p",null,"You can download Pathom Viz at the ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/wilkerlucio/pathom-viz/releases/"}),"releases page"),"."),Object(r.b)("h4",{id:"mac-os-notes"},"Mac OS Notes"),Object(r.b)("p",null,"Notice that I don't have an Apple ID so I can't sign the app on the Mac version, to run the app:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Download the ",Object(r.b)("inlineCode",{parentName:"li"},".dmg")," file"),Object(r.b)("li",{parentName:"ul"},"Open and drag pathom to the Applications"),Object(r.b)("li",{parentName:"ul"},"Open the Applications folder on Finder"),Object(r.b)("li",{parentName:"ul"},"Attempt to open the app (you will see a message saying the app isn't signed, options to delete or cancel)"),Object(r.b)("li",{parentName:"ul"},"Right-click on it and click open (this is important, don't just double-click on it)"),Object(r.b)("li",{parentName:"ul"},"It may show the ",Object(r.b)("inlineCode",{parentName:"li"},"Open")," button on the dialog. If not, repeat the previous step, and it should appear")),Object(r.b)("h3",{id:"connect-the-app"},"Connect the app"),Object(r.b)("p",null,"The next step is to connect your ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/environment"}),"environment")," with the app."),Object(r.b)("p",null,"First you have to include the ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/wilkerlucio/pathom-viz-connector"}),"Pathom Viz Connector"),"\ndependency to your project:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-clojure"}),'{:deps {com.wsscode/pathom-viz-connector\n        {:mvn/version "2021.01.25"}}}\n')),Object(r.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(r.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(r.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"tip")),Object(r.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"You can also do it with a local deps aliases:"),Object(r.b)("pre",{parentName:"div"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-clojure"}),'{:aliases\n {:dev/pathom-tools\n  {:extra-deps\n    {com.wsscode/pathom-viz-connector\n     {:mvn/version "2021.01.25"}}}}}\n')))),Object(r.b)("p",null,"If you didn't open the Pathom Viz app yet, do it now."),Object(r.b)("p",null,"Then, set up your environment to connect with the app:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-clojure"}),"(ns com.wsscode.pathom-viz.connector.demos.pathom3\n  (:require [com.wsscode.pathom.viz.ws-connector.core :as pvc]\n            [com.wsscode.pathom.viz.ws-connector.pathom3 :as p.connector]\n            [com.wsscode.pathom3.connect.built-in.resolvers :as pbir]\n            [com.wsscode.pathom3.connect.indexes :as pci]\n            [com.wsscode.pathom3.interface.eql :as p.eql]))\n\n; you can use goog.defines on ClojureScript or env vars in Clojure\n; the important part is to have a flag to decide when to connect the parser\n(def CONNECT_PARSER? true)\n\n(def registry\n  [(pbir/constantly-resolver :pi Math/PI)\n   (pbir/single-attr-resolver :pi :tau #(* 2 %))])\n\n(def env\n  (cond-> (pci/register registry)\n    CONNECT_PARSER?\n    ; give your environment a unique parser-id, this will ensure reconnects work as\n    ; expected\n    (p.connector/connect-env {::pvc/parser-id `env})))\n\n(comment\n  (p.eql/process env\n    [:tau]))\n")),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(r.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(r.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"The attribute name ",Object(r.b)("inlineCode",{parentName:"p"},"::pvc/parser-id")," is an inheritance from Pathom 2, keeping this\nname for compatibility."))),Object(r.b)("p",null,"Once you load this file, you should see a new tab appearing in Pathom Viz:"),Object(r.b)("div",{className:"pathom-diagram"},Object(r.b)("p",null,"  ",Object(r.b)("img",{alt:"Pathom Viz",src:a(317).default}))),Object(r.b)("h3",{id:"query-editor"},"Query Editor"),Object(r.b)("p",null,"The query editor provides an environment to run queries using your connected environment."),Object(r.b)("div",{className:"pathom-diagram"},Object(r.b)("p",null,"  ",Object(r.b)("img",{alt:"Pathom Viz",src:a(318).default}))),Object(r.b)("p",null,"The query editor provides auto-complete for exploration:"),Object(r.b)("div",{className:"pathom-diagram"},Object(r.b)("p",null,"  ",Object(r.b)("img",{alt:"Pathom Viz",src:a(319).default}))),Object(r.b)("p",null,"The auto-complete is contextual. This means depending on which part of the query you are,\nPathom Viz will offer different attribute suggestions."),Object(r.b)("p",null,"When you run a query, the result will appear on the right, and the query is saved to\na query history."),Object(r.b)("p",null,"Bellow the results there is the trace viewer, described in the next section."),Object(r.b)("h3",{id:"tracer-view"},"Tracer View"),Object(r.b)("p",null,"The tracer view displays a timeline of the things that happened during the query process."),Object(r.b)("div",{className:"pathom-diagram"},Object(r.b)("p",null,"  ",Object(r.b)("img",{alt:"Pathom Viz",src:a(320).default}))),Object(r.b)("h4",{id:"trace-blocks"},"Trace blocks"),Object(r.b)("p",null,"Each gray block in the timeline can be one of:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"A graph process: the first short bar is one, but also when a process trigger sub-processes, each sub-process has its graph bar"),Object(r.b)("li",{parentName:"ol"},"Node execution: these bars go below the graph process and represent the execution of a node in the graph")),Object(r.b)("p",null,"Inside the bars, you will see events that cover part of it."),Object(r.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(r.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(r.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"tip")),Object(r.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"Mouse over the events to see more details and the precise duration of each."),Object(r.b)("p",{parentName:"div"},"In that hint, you can see the times for each event under the mouse. You will also see\none or two badges on the right side."),Object(r.b)("p",{parentName:"div"},"The green one is the number of events in that block. The yellow one\ntells how many direct children this block has (this is absent when the number of\nchildren are zero)."))),Object(r.b)("p",null,"You will see some different colors filling the blocks. These are their meaning:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Green: generic events"),Object(r.b)("li",{parentName:"ul"},"Purple: resolver call"),Object(r.b)("li",{parentName:"ul"},"Red: failed operation"),Object(r.b)("li",{parentName:"ul"},"Blue: batch resolver call")),Object(r.b)("h4",{id:"nested-traces"},"Nested traces"),Object(r.b)("p",null,"When Pathom process a sub-query, that nested details are placed below the block, they\nhappened. In this case, you will see a ",Object(r.b)("inlineCode",{parentName:"p"},"+")," OR ",Object(r.b)("inlineCode",{parentName:"p"},"-")," icon on the left side of the block."),Object(r.b)("p",null,"Use this to toggle the visibility of the children's blocks."),Object(r.b)("div",{className:"pathom-diagram"},Object(r.b)("p",null,"  ",Object(r.b)("img",{alt:"Pathom Viz",src:a(321).default}))),Object(r.b)("p",null,"When you mouse over a block with children, Pathom Viz creates a box around that to\nmake it easier to see the boundaries of it."),Object(r.b)("h4",{id:"view-the-graph"},"View the graph"),Object(r.b)("p",null,"By clicking on a block you can see the node of that block, and the plan in which it\nwas projected. This will open the Graph View, described in the next section."),Object(r.b)("h3",{id:"graph-view"},"Graph View"),Object(r.b)("p",null,"When you click on a block in the Trace View, it opens the graph view below it:"),Object(r.b)("div",{className:"pathom-diagram"},Object(r.b)("p",null,"  ",Object(r.b)("img",{alt:"Pathom Viz",src:a(322).default}))),Object(r.b)("p",null,"This graph represents what the ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/planner"}),"planner")," generated for this execution."),Object(r.b)("p",null,"If you clicked on a graph block, the graph opens without any node selected. In case\nyou clicked on a node block that nodes start in focus on the graph, marked by a red\nborder."),Object(r.b)("p",null,"You will see different colors for nodes, here are their meaning:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Green: a node executed with success"),Object(r.b)("li",{parentName:"ul"},"Gray: a node that didn't run"),Object(r.b)("li",{parentName:"ul"},"Yellow: a node that ran but got an empty response"),Object(r.b)("li",{parentName:"ul"},"Red: a node that failed to run"),Object(r.b)("li",{parentName:"ul"},"Purple: ",Object(r.b)("inlineCode",{parentName:"li"},"AND")," node"),Object(r.b)("li",{parentName:"ul"},"Blue: ",Object(r.b)("inlineCode",{parentName:"li"},"OR")," node")),Object(r.b)("p",null,"A node with a black border means it's the root of the graph."),Object(r.b)("p",null,"There are also different kinds of edges between the nodes:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Orange edges: these happen on ",Object(r.b)("inlineCode",{parentName:"li"},"AND")," and ",Object(r.b)("inlineCode",{parentName:"li"},"OR")," nodes, which means the branches of this composing node"),Object(r.b)("li",{parentName:"ul"},"Black edge: means the node to run after the current node. In the cases of branch nodes, the branches run first, and then the next runs.")),Object(r.b)("p",null,"When a node is selected, its details show up on the right side of the graph. The details section contains the map with all node information available."),Object(r.b)("p",null,"The following graph is a more complex example that has almost all of the node types and\nedges (there are no failed nodes in this example):"),Object(r.b)("div",{className:"pathom-diagram"},Object(r.b)("p",null,"  ",Object(r.b)("img",{alt:"Pathom Viz",src:a(214).default}))),Object(r.b)("p",null,"You can click on a node in the graph to select it."),Object(r.b)("p",null,"When you select a node, the visualization will fit that node, and the nodes connected\nto it in the viewport."),Object(r.b)("h3",{id:"index-explorer"},"Index Explorer"),Object(r.b)("p",null,"In this panel, you can explore the attributes, resolvers, and mutations of your graph."),Object(r.b)("p",null,"To learn about this, please ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://blog.wsscode.com/pathom/v2/pathom/2.2.0/connect/exploration.html"}),"check the previous index explorer docs"),".\nThe behavior of them in Pathom 3 is the same as in Pathom 2. This view may evolve in\nthe future to support more of the features from Pathom 3."),Object(r.b)("h3",{id:"requests"},"Requests"),Object(r.b)("p",null,"The requests tab is where you can see a log of the requests made to your environment."),Object(r.b)("p",null,"This view is very much like the Query Editor, without the editing part."),Object(r.b)("div",{className:"pathom-diagram"},Object(r.b)("p",null,"  ",Object(r.b)("img",{alt:"Pathom Viz",src:a(214).default}))),Object(r.b)("p",null,"You can see trace and graph view in the same way as in the Query Editor."))}l.isMDXComponent=!0},97:function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return u}));var n=a(0),o=a.n(n);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var p=o.a.createContext({}),l=function(e){var t=o.a.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):c(c({},t),e)),a},b=function(e){var t=l(e.components);return o.a.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},h=o.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,i=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),b=l(a),h=n,u=b["".concat(i,".").concat(h)]||b[h]||d[h]||r;return a?o.a.createElement(u,c(c({ref:t},p),{},{components:a})):o.a.createElement(u,c({ref:t},p))}));function u(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,i=new Array(r);i[0]=h;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:n,i[1]=c;for(var p=2;p<r;p++)i[p]=a[p];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,a)}h.displayName="MDXCreateElement"}}]);